# Matuda

Control panel for [Matugen](https://github.com/InioX/matugen) with service and daemon that detects wallpaper changes in GNOME and recreates templates

## Install

### Requirements

- Linux OS.
- Systemd.
- GNOME.

### Steps

- Download the binary corresponding to your package manager [here]().
- Install and run.

## Usage

### Initialize the app

The first thing you will see is a button to initialize the app. This does the following:

- Copies the Matugen binary, the Daemon, and the basic configuration to `~/.config/matuda/`.
- Creates a user-level service in `~/.config/systemd/user/`.
- Starts the service created above.

### Control Panel

In this section, you can:

- View the service status (the output of `systemd status`).
- Start the service.
- Restart the service.
- Stop the service.
- Activate the CSS generated by Matugen.
- Load the CSS by Matugen.
- Clear the app.

> You must manually load the CSS after generating it with Matugen by clicking the button mentioned above.

> Clean the app deletes everything that was generated in `~/.config/matuda/` and the service in `~/.config/systemd/user/matuda-daemon.service`.

### Matuda Config

Here you will find:

- Settings for palette generation.
- Template management.

To learn about these settings, visit the Matugen documentation.

If you want a Matugen feature that has not yet been included, open an issue [here]().

## Development

### Requirements

I recommend using the devcontainer included in the repo to install all dependencies automatically. If you want to know the dependencies needed to develop outside the container, they are listed below:

- Cargo
- NodeJS and NPM

Dependencies are also required for Tauri and AppImage generation for Ubuntu:

- libwebkit2gtk-4.1-0=2.44.0-2
- libwebkit2gtk-4.1-dev=2.44.0-2
- libjavascriptcoregtk-4.1-0=2.44.0-2
- libjavascriptcoregtk-4.1-dev=2.44.0-2
- gir1.2-javascriptcoregtk-4.1=2.44.0-2
- gir1.2-webkit2-4.1=2.44.0-2
- build-essential
- curl
- wget
- file
- libxdo-dev
- libssl-dev
- libayatana-appindicator3-dev
- librsvg2-dev
- xdg-utils

> You can adjust the name and versions of the packages according to your distro. However, it is recommended to build the AppImage on Ubuntu with these dependencies, or there will be a white window error.

### Install Node dependencies

```bash
npm i
```

### Project structure

Matuda/
├─ daemon/
│ ├─ main.rs
├─ scripts/
├─ src/
│ ├─ components/
│ ├─ data/
│ ├─ layout/
│ ├─ pages/
│ ├─ store/
│ ├─ types/
│ ├─ App.css
│ ├─ App.tsx
│ ├─ main.tsx
├─ src-tauri/
│ ├─ capabilities/
│ ├─ icons/
│ ├─ resources/
│ ├─ src/
│ ├─ build.rs
│ ├─ Cargo.toml
│ ├─ tauri.conf.json
├─ .gitignore
├─ package.json
├─ README.md

> Some files and folders are omitted.

All the Daemon code is located in `daemon/main.rs`, and the Cargo configuration for that project is in the same folder.

In `scripts/` are the scripts to compile the Daemon and Matugen binary. You can run individually with:

```bash
npm run build:daemon
npm run build:matugen
```

#### Front-End

In `src/` is everything related to the front-end, built with React.

In `src/components/` are the reusable components. There is no direct information about the application; they are only reused to build the interface.

In `src/data/` are the objects for the color schemes and filters. The first key of each object corresponds to the value that will be stored and used in the Store and transmitted to the back-end.

> If entries are added or deleted, modify the corresponding types related to the Store.

In `src/layout/` is the component that wraps all pages. Here you will find the component in charge of Split View, some effects that need stability, among other components.

In `src/pages/` are all the components that make up the puzzle of each page. In each folder, you will see a main component in charge of orchestrating, and in the subfolders of `components` will be the sections of these pages that use the aforementioned reusable components. In the `hooks` folder are the hooks (logic) for each component.

The values and functions of the Store are located in `src/store/`. It is managed with Zustand.

In `src/App.tsx`, you will find the route schema created with React Router.

#### Back-End

`src-tauri` contains all the Rust code used by the application.

`src-tauri/resources/` contains the binaries and a CSS template. Keeping them here is necessary so that Tauri can copy them and place them in the corresponding paths after initializing the application.

`src-tauri/src/` contains all the Rust code. In `appmanager.rs` is the Daemon object that contains all the functions that make the back-end work. In `commands.rs` are the functions that communicate with the front-end.

In `src-tauri/tauri.conf.json` is the configuration for building the application, such as the version number, icons, window behavior, etc.

### Building

Build the application using

```bash
npm run build:app
```

## Contributing

Contributions are welcome. Please open an issue to discuss proposed changes before submitting a pull request.

## License

This project is licensed under the GPL-3.0 License. See LICENSE file for details.

## Acknowledgments

- [Matugen](https://github.com/InioX/matugen) - Color palette generation.
- [Tauri](https://tauri.app/) - Cross-platform application framework.
- [React](https://react.dev/) - The library for web interfaces.
- [Zustand](https://zustand.docs.pmnd.rs/getting-started/introduction) - Lightweight library for global state management in React applications.
- [TailwindCSS](https://tailwindcss.com/) - A utility-first CSS framework.
- [React Colorful](https://github.com/omgovich/react-colorful) - A tiny color picker component for React.
- [React Router DOM](https://reactrouter.com/) - Routing library for React.

## Support

For issues, questions, or feature requests, please use the [GitHub Issues]() page.
